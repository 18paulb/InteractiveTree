<!DOCTYPE html>

<html lang='en'>

    <head>
        <meta charset="utf-8">
        <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js'></script>
    </head>



    <body>

        <h1>Testing</h1>
<!--
        {% if node_list %}
            {% for node in node_list %}
                <div><h3>Image: {{node.image}} Mother: {{node.mother}} Spouse: {{node.spouse}} Birthyear {{node.birthyear}}</h3></div>
            {% endfor %}
        {% endif %}
-->
        <script>
        //let data = null;
        /*
        $.ajax(
            {
                type: "GET",
                url: "{% url 'getNodes' %}",
                success: function (response) {
                    data = JSON.parse(response);
                    for (let i = 0; i < data.length; ++i) {
                        data[i] = data[i].fields
                    }
                },
                error: function (response) {
                    console.log(response);
                }
            }
        )
        */
        async function getData() {
            let test = await $.ajax({
                type: "GET",
                url: "{% url 'getNodes' %}",
                success: function (response) {
                   return response
                },
                
                error: function (response) {
                    console.log(response);
                },
            })

            test = JSON.parse(test);

            for (let i = 0; i < test.length; ++i) {
                test[i] = test[i].fields;
            }

            return test
            //return Promise.resolve(test)
        }



        //FIXME: Unresolved promise, data is there but cannot be accessed

        //let tmp = Promise.resolve(getData()).then(data => {return data;})
        let tmp
        getData()
        .then(data => {
            console.log(data)
            tmp = data;
            console.log(tmp)
        })

        console.log(tmp)


        </script>


    </body>

</html>