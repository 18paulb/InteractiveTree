<!DOCTYPE html>

<html lang='en'>

    <head>
        <meta charset="utf-8">
        <script src='https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js'></script>
    </head>



    <body>

        <h1>Testing</h1>
<!--
        {% if node_list %}
            {% for node in node_list %}
                <div><h3>Image: {{node.image}} Mother: {{node.mother}} Spouse: {{node.spouse}} Birthyear {{node.birthyear}}</h3></div>
            {% endfor %}
        {% endif %}
-->
        <script>
        async function getData() {
            let test = await $.ajax({
                type: "GET",
                dataType: "json",
                url: "{% url 'getNodes' %}",
                success: function (response) {
                    return response
                },
                
                error: function (response) {
                    console.log(response);
                },
            })

            //test = JSON.parse(test);

            for (let i = 0; i < test.length; ++i) {
                test[i] = test[i].fields;
            }

            return test
        }


        function getResult() {
            getData()
            .then(response => {
                return response;
            })

        }

        let data = getResult();

        console.log(data)


/*
    async function pp() { 
            await fetch("{% url 'getNodes' %}", {
            method: "GET",
            headers: {
                "X-Requested-With": "XMLHttpRequest",
            }
        })
        .then(response => response)
        .then(data => { 
            return data;
        })
    }   
    
    let tmp = pp();
*/
        //FIXME: Unresolved promise, data is there but cannot be accessed




        </script>


    </body>

</html>